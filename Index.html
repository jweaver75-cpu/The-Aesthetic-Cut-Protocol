<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classic Physique Cutting Blueprint</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0ffef; /* Light green-white background */
            color: #1E1E1E;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            padding: 1.5rem;
            border-top: 5px solid #00C853; /* Green accent color */
        }
        .accent-text {
            color: #00C853; /* Green accent color */
        }
        .stat-number {
            color: #2196F3; /* Blue for the number value */
            line-height: 1.1;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .flow-node {
            background-color: #E8F5E9; /* Light green node background */
            border: 2px solid #00C853;
            color: #1E1E1E;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 200, 83, 0.2);
            position: relative;
            text-align: center;
        }
        .flow-arrow {
            color: #00C853;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
        }
        .button-shadow {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.15s ease-in-out;
        }
        .button-shadow:hover {
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);
            transform: translateY(-1px);
        }
        .meal-card {
            border-left: 5px solid;
            padding: 1rem;
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        /* Custom responsive grid for the 7-day split */
        .day-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2 columns on small screens */
            gap: 0.75rem;
        }
        @media (min-width: 640px) {
            .day-grid {
                grid-template-columns: repeat(4, 1fr); /* 4 columns on medium screens */
            }
        }
        @media (min-width: 1024px) {
            .day-grid {
                grid-template-columns: repeat(7, 1fr); /* 7 columns on large screens */
            }
        }
    </style>
</head>
<body class="p-4 md:p-10">
    
    <script type="module">
        // Global Data for Charts and AI context - UPDATED FOR NEW MEAL PLAN
        const chartData = {
            totalCalories: 2000, targetProtein: 215, targetCarbs: 110, targetFat: 75, // Updated Targets
            macroLabels: ['Protein (44%)', 'Carbohydrates (22%)', 'Fats (34%)'], macroPercentages: [44, 22, 34], // Updated Percentages
            mealLabels: ['Meal 1: Whey Shake', 'Meal 2: Solid Meal 1', 'Meal 3: Whey Shake', 'Meal 4: Solid Meal 2', 'Meal 5: Whey Shake'], 
            mealCalories: [320, 500, 320, 500, 320], // Updated Calories for 5 meals (Total 1960 kcal - close to 2000)
            proteinSources: [{ source: 'Whey Protein', grams: 192, color: '#2196F3' }, { source: 'Other Sources', grams: 23, color: '#FF9800' }], // Updated Protein Sources
            chartColors: ['#00C853', '#FF9800', '#2196F3', '#03A9F4', '#8BC34A', '#FFC107'], // Adjusted color palette
        };

        const apiKey = ""; 
        const FLASH_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        const TTS_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;

        // --- Core AI Helper Functions (omitted for brevity, assume they are correct) ---
        function base64ToArrayBuffer(base64) {
            const binaryString = atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }

        function pcmToWav(pcm16, sampleRate = 16000) {
            const numChannels = 1;
            const numSamples = pcm16.length;
            const buffer = new ArrayBuffer(44 + numSamples * 2);
            const view = new DataView(buffer);

            let pos = 0;

            view.setUint32(pos, 0x52494646, false); pos += 4;
            view.setUint32(pos, 36 + numSamples * 2, true); pos += 4;
            view.setUint32(pos, 0x57415645, false); pos += 4;
            view.setUint32(pos, 0x666d7420, false); pos += 4;
            view.setUint32(pos, 16, true); pos += 4;
            view.setUint16(pos, 1, true); pos += 2;
            view.setUint16(pos, numChannels, true); pos += 2;
            view.setUint32(pos, sampleRate, true); pos += 4;
            view.setUint32(pos, sampleRate * numChannels * 2, true); pos += 4;
            view.setUint16(pos, numChannels * 2, true); pos += 2;
            view.setUint16(pos, 16, true); pos += 2;
            view.setUint32(pos, 0x64617461, false); pos += 4;
            view.setUint32(pos, numSamples * 2, true); pos += 4;

            for (let i = 0; i < numSamples; i++) {
                view.setInt16(pos, pcm16[i], true);
                pos += 2;
            }

            return new Blob([buffer], { type: 'audio/wav' });
        }

        async function callGeminiApi(url, payload, maxRetries = 5) {
            let lastError = null;
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorBody = await response.text();
                        throw new Error(`API call failed with status ${response.status}: ${errorBody}`);
                    }

                    return await response.json();

                } catch (error) {
                    lastError = error;
                    if (i < maxRetries - 1) {
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        console.error("Gemini API call failed after multiple retries.", lastError);
                        throw new Error("Failed to connect to the AI service. Please try again.");
                    }
                }
            }
        }
        
        // --- Chart Rendering Functions ---

        function processLabel(label) {
            if (label.length <= 16) return label;
            const words = label.split(' ');
            let lines = [];
            let currentLine = '';
            words.forEach(word => {
                if ((currentLine + ' ' + word).length > 16 && currentLine.length > 0) {
                    lines.push(currentLine);
                    currentLine = word;
                } else {
                    currentLine = currentLine ? currentLine + ' ' + word : word;
                }
            });
            if (currentLine) lines.push(currentLine);
            return lines;
        }

        const sharedTooltipConfig = {
            plugins: {
                tooltip: {
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            let label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) {
                              return label.join(' ');
                            } else {
                              return label;
                            }
                        }
                    }
                }
            },
            responsive: true,
            maintainAspectRatio: false
        };

        function renderMacroDonutChart() {
            const ctx = document.getElementById('macroDonutChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: chartData.macroLabels.map(processLabel),
                    datasets: [{
                        data: chartData.macroPercentages,
                        backgroundColor: chartData.chartColors.slice(0, 3),
                        hoverOffset: 15,
                    }]
                },
                options: {
                    ...sharedTooltipConfig,
                    cutout: '70%',
                    plugins: {
                        legend: { position: 'bottom' },
                        ...sharedTooltipConfig.plugins
                    }
                }
            });
        }

        function renderCalorieLineChart() {
            const ctx = document.getElementById('calorieLineChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: chartData.mealLabels.map(processLabel),
                    datasets: [{
                        label: `Calories Per Meal (Target: ${chartData.totalCalories} Total)`,
                        data: chartData.mealCalories,
                        borderColor: '#00C853',
                        backgroundColor: 'rgba(0, 200, 83, 0.2)',
                        tension: 0.4,
                        fill: true,
                        pointRadius: 6,
                        pointBackgroundColor: '#2196F3'
                    }]
                },
                options: {
                    ...sharedTooltipConfig,
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Calories (kcal)', color: '#1E1E1E' } },
                        x: { title: { display: true, text: 'Meal Timing', color: '#1E1E1E' } }
                    },
                    plugins: {
                        legend: { display: false },
                        ...sharedTooltipConfig.plugins
                    }
                }
            });
        }

        function renderProteinBarChart() {
            const ctx = document.getElementById('proteinBarChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: chartData.proteinSources.map(d => d.source).map(processLabel),
                    datasets: [{
                        label: 'Protein (Grams)',
                        data: chartData.proteinSources.map(d => d.grams),
                        backgroundColor: chartData.proteinSources.map(d => d.color),
                    }]
                },
                options: {
                    ...sharedTooltipConfig,
                    indexAxis: 'y',
                    scales: {
                        x: { beginAtZero: true, title: { display: true, text: 'Grams of Protein', color: '#1E1E1E' } }
                    },
                    plugins: {
                        legend: { display: false },
                        ...sharedTooltipConfig.plugins
                    }
                }
            });
        }

        // --- KPI Update Function (FIXED: Injection of values into HTML) ---
        function updateKPIs() {
            document.getElementById('kpi-calories').textContent = chartData.totalCalories;
            document.getElementById('kpi-protein').textContent = chartData.targetProtein;
            document.getElementById('kpi-carbs').textContent = chartData.targetCarbs;
            document.getElementById('kpi-fat').textContent = chartData.targetFat;

            document.getElementById('kpi-protein-perc').textContent = chartData.macroPercentages[0];
            document.getElementById('kpi-carbs-perc').textContent = chartData.macroPercentages[1];
            document.getElementById('kpi-fat-perc').textContent = chartData.macroPercentages[2];
            
            // Update labels with macro percentages
            document.getElementById('macro-p-perc').textContent = chartData.macroPercentages[0];
            document.getElementById('macro-c-perc').textContent = chartData.macroPercentages[1];
            document.getElementById('macro-f-perc').textContent = chartData.macroPercentages[2];
            
            // Update line chart subtitle
            document.getElementById('line-chart-total').textContent = chartData.totalCalories;
            
        }

        // --- AI Interaction Functions (omitted for brevity) ---
        async function generateSubstitution() {
            const inputFood = document.getElementById('inputFood').value.trim();
            const resultDiv = document.getElementById('substitutionResult');
            const button = document.getElementById('substitutionButton');

            if (!inputFood) {
                resultDiv.innerHTML = '<p class="text-red-500">Please enter a food item to substitute.</p>';
                return;
            }

            resultDiv.innerHTML = '<p class="text-gray-500 flex items-center justify-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-accent-text" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating macro-matched swap...</p>';
            button.disabled = true;

            const systemPrompt = `You are an expert nutrition coach for competitive physique athletes. Your goal is to provide a single, clean, macro-matched food substitution based on the user's input. The current plan is a ${chartData.totalCalories} kcal cutting diet with ${chartData.targetProtein}g Protein, ${chartData.targetCarbs}g Carbs, ${chartData.targetFat}g Fat. Your substitution should maintain the high protein/low-fat focus. Provide only the food name, macronutrients, and a brief note on its use in the plan. Format the output as a simple paragraph.`;
            
            const userQuery = `I need a macro-matched substitute for "${inputFood}" in my cutting diet.`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const result = await callGeminiApi(FLASH_API_URL, payload);
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I couldn't find a suitable substitution.";
                
                resultDiv.innerHTML = `
                    <div class="mt-4 p-4 border border-[#2196F3] bg-blue-50 rounded-lg">
                        <h4 class="font-bold accent-text mb-2">‚ú® Suggested Swap:</h4>
                        <p class="text-gray-800">${text}</p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<p class="text-red-500">Error generating substitution: ${error.message}</p>`;
            } finally {
                button.disabled = false;
            }
        }

        async function generateRationale() {
            const rationaleTopic = document.getElementById('rationaleTopic').value.trim();
            const rationaleResultDiv = document.getElementById('rationaleResult');
            const button = document.getElementById('rationaleButton');

            if (!rationaleTopic) {
                rationaleResultDiv.innerHTML = '<p class="text-red-500">Please enter a nutrition question (e.g., "Why high protein?").</p>';
                return;
            }

            rationaleResultDiv.innerHTML = '<p class="text-gray-500 flex items-center justify-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-accent-text" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Grounding response with current research...</p>';
            button.disabled = true;

            const systemPrompt = `You are a sports science researcher. Provide a concise, scientifically grounded, 3-4 sentence explanation for the user's nutrition question, focusing on bodybuilding and cutting phases, considering a ${chartData.totalCalories} kcal / ${chartData.targetProtein}g protein diet.`;
            
            const userQuery = `Explain the rationale behind this nutrition topic: "${rationaleTopic}"`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                tools: [{ "google_search": {} }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const result = await callGeminiApi(FLASH_API_URL, payload);
                const candidate = result.candidates?.[0];
                const text = candidate?.content?.parts?.[0]?.text || "Sorry, I couldn't retrieve a grounded scientific explanation.";
                
                let sourcesHtml = '';
                const groundingMetadata = candidate?.groundingMetadata;
                if (groundingMetadata && groundingMetadata.groundingAttributions) {
                    const sources = groundingMetadata.groundingAttributions
                        .map(attr => ({ uri: attr.web?.uri, title: attr.web?.title }))
                        .filter(source => source.uri && source.title)
                        .slice(0, 3);

                    if (sources.length > 0) {
                        sourcesHtml = '<div class="mt-3 text-xs text-gray-500">Sources: ' + 
                            sources.map(s => `<a href="${s.uri}" target="_blank" class="hover:underline">${s.title.substring(0, 30)}...</a>`).join(' | ') + 
                            '</div>';
                    }
                }

                rationaleResultDiv.innerHTML = `
                    <div class="mt-4 p-4 border border-[#00C853] bg-green-50 rounded-lg">
                        <h4 class="font-bold text-[#00C853] mb-2">üî¨ Scientific Rationale:</h4>
                        <p class="text-gray-800">${text}</p>
                        ${sourcesHtml}
                    </div>
                `;

            } catch (error) {
                rationaleResultDiv.innerHTML = `<p class="text-red-500">Error generating rationale: ${error.message}</p>`;
            } finally {
                button.disabled = false;
            }
        }
        
        async function speakPrinciples() {
            const principleText = document.getElementById('principles-text-container').innerText.replace(/\s+/g, ' ').trim();
            const audioPlayer = document.getElementById('audioPlayer');
            const button = document.getElementById('ttsButton');
            
            if (audioPlayer.paused === false && !audioPlayer.ended) {
                audioPlayer.pause();
                audioPlayer.currentTime = 0;
                button.innerHTML = 'üîä Hear Principles Read';
                button.classList.remove('bg-red-500', 'hover:bg-red-600');
                button.classList.add('bg-[#00C853]', 'hover:bg-[#8BC34A]');
                return;
            }

            button.disabled = true;
            button.innerHTML = '<svg class="animate-spin h-5 w-5 mr-3 inline text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating Audio...';
            
            const systemPrompt = `Read the following text in an informative and firm tone, suitable for a fitness professional.`;
            
            const payload = {
                contents: [{ parts: [{ text: principleText }] }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: {
                        voiceConfig: {
                            prebuiltVoiceConfig: { voiceName: "Kore" }
                        }
                    }
                },
                model: "gemini-2.5-flash-preview-tts"
            };
            
            try {
                const result = await callGeminiApi(TTS_API_URL, payload);
                const part = result?.candidates?.[0]?.content?.parts?.[0];
                const audioData = part?.inlineData?.data;
                const mimeType = part?.inlineData?.mimeType;

                if (audioData && mimeType && mimeType.startsWith("audio/L16")) {
                    const match = mimeType.match(/rate=(\d+)/);
                    const sampleRate = match ? parseInt(match[1], 10) : 16000;
                    const pcmData = base64ToArrayBuffer(audioData);
                    const pcm16 = new Int16Array(pcmData);
                    const wavBlob = pcmToWav(pcm16, sampleRate);
                    
                    const audioUrl = URL.createObjectURL(wavBlob);
                    audioPlayer.src = audioUrl;
                    audioPlayer.play();
                    
                    button.innerHTML = 'üõë Stop Reading';
                    button.classList.remove('bg-[#00C853]', 'hover:bg-[#8BC34A]');
                    button.classList.add('bg-red-500', 'hover:bg-red-600');
                    
                    audioPlayer.onended = () => {
                        button.innerHTML = 'üîä Hear Principles Read';
                        button.classList.remove('bg-red-500', 'hover:bg-red-600');
                        button.classList.add('bg-[#00C853]', 'hover:bg-[#8BC34A]');
                    };
                } else {
                    console.error("TTS response missing audio data or invalid mime type:", mimeType);
                    // No alert message needed, just revert button
                }
            } catch (error) {
                button.innerHTML = '‚ùå TTS Error';
                console.error("TTS Error:", error);
            } finally {
                button.disabled = false;
                if (button.innerHTML.includes('Generating') || button.innerHTML.includes('Error')) {
                     button.innerHTML = 'üîä Hear Principles Read';
                     button.classList.remove('bg-red-500', 'hover:bg-red-600');
                     button.classList.add('bg-[#00C853]', 'hover:bg-[#8BC34A]');
                }
            }
        }


        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            updateKPIs(); // <-- NOW CALLS FUNCTION TO INJECT NUMBERS
            renderMacroDonutChart();
            renderCalorieLineChart();
            renderProteinBarChart();
        });

        // Expose functions globally for HTML calls
        window.generateSubstitution = generateSubstitution;
        window.generateRationale = generateRationale;
        window.speakPrinciples = speakPrinciples;

    </script>

    <div class="max-w-7xl mx-auto">

        <header class="text-center mb-12">
            <h1 class="text-5xl md:text-6xl font-extrabold accent-text leading-tight">The Aesthetic Cut Protocol</h1>
            <p class="text-xl md:text-2xl text-gray-600 mt-3">Classic Physique Nutrition Blueprint for Definition and V-Taper</p>
        </header>

        
<!-- UPDATED: Replaced template literals with target IDs for JavaScript injection -->
<section id="kpis" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            
            <div class="card p-6 text-center">
                <h2 class="text-sm uppercase font-bold text-gray-500 mb-2">Daily Calorie Target</h2>
                <div class="stat-number text-6xl font-black" id="kpi-calories"></div>
                <p class="text-gray-700 mt-2 font-semibold">kcal</p>
            </div>

            <div class="card p-6 text-center">
                <h2 class="text-sm uppercase font-bold text-gray-500 mb-2">Protein Intake (Minimum)</h2>
                <div class="stat-number text-6xl font-black" id="kpi-protein"></div>
                <p class="text-gray-700 mt-2 font-semibold">grams / <span id="kpi-protein-perc"></span>%</p>
            </div>

            <div class="card p-6 text-center">
                <h2 class="text-sm uppercase font-bold text-gray-500 mb-2">Carbohydrate Intake</h2>
                <div class="stat-number text-6xl font-black" id="kpi-carbs"></div>
                <p class="text-gray-700 mt-2 font-semibold">grams / <span id="kpi-carbs-perc"></span>%</p>
            </div>

            <div class="card p-6 text-center">
                <h2 class="text-sm uppercase font-bold text-gray-500 mb-2">Fat Intake (Essential)</h2>
                <div class="stat-number text-6xl font-black" id="kpi-fat"></div>
                <p class="text-gray-700 mt-2 font-semibold">grams / <span id="kpi-fat-perc"></span>%</p>
            </div>
            
        </section>

        

<section id="ai-tools" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b-2 pb-2 border-gray-200">ü§ñ AI Nutrition Assistant (Gemini-Powered)</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                
                

<div class="card p-6 border-t-4 border-t-[#2196F3] bg-blue-50/50">
                    <h3 class="text-xl font-bold text-[#2196F3] mb-3 flex items-center">‚ú® Macro Substitution Generator</h3>
                    <p class="text-gray-700 text-sm mb-4">Need to swap out a food item while keeping your macros tight? The AI will suggest a macro-matched, cutting-friendly alternative.</p>
                    <input type="text" id="inputFood" placeholder="e.g., Brown Rice" class="w-full p-2 mb-3 border border-gray-300 rounded-md focus:ring-[#2196F3] focus:border-[#2196F3]">
                    <button id="substitutionButton" onclick="generateSubstitution()" class="w-full bg-[#2196F3] text-white py-2 rounded-md font-semibold hover:bg-blue-600 button-shadow">
                        Generate Swap
                    </button>
                    <div id="substitutionResult" class="mt-4 min-h-[50px]"></div>
                </div>

                

<div class="card p-6 border-t-4 border-t-[#00C853] bg-green-50/50">
                    <h3 class="text-xl font-bold text-[#00C853] mb-3 flex items-center">üî¨ Scientific Rationale Finder</h3>
                    <p class="text-gray-700 text-sm mb-4">Get a quick, grounded scientific explanation for the principles in this plan. Utilizes real-time research.</p>
                    <input type="text" id="rationaleTopic" placeholder="e.g., Carb timing vs fat loss" class="w-full p-2 mb-3 border border-gray-300 rounded-md focus:ring-[#00C853] focus:border-[#00C853]">
                    <button id="rationaleButton" onclick="generateRationale()" class="w-full bg-[#00C853] text-white py-2 rounded-md font-semibold hover:bg-green-600 button-shadow">
                        Search Rationale
                    </button>
                    <div id="rationaleResult" class="mt-4 min-h-[50px]"></div>
                </div>
            </div>
        </section>

        

<section id="meal-recommendations" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b-2 pb-2 border-gray-200">üçΩÔ∏è Sample Meal Plan: Ultra-High Protein Focus</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                
                

<div class="meal-card border-l-[#FF9800]">
                    <h3 class="text-lg font-bold text-[#FF9800] mb-2">Meal 1: High-Dose Whey Shake (320 kcal)</h3>
                    <p class="text-sm text-gray-700 font-semibold">Focus: 64g Pure Protein, Quick Absorb</p>
                    <ul class="list-disc list-inside text-sm text-gray-600 mt-2 space-y-1">
                        <li>2.6 Scoops Gold Standard Whey (64g Protein)</li>
                        <li>Mixed with Water</li>
                        <li>*(Ensure accurate measurement for 64g)*</li>
                    </ul>
                </div>
                
                

<div class="meal-card border-l-[#00C853]">
                    <h3 class="text-lg font-bold text-[#00C853] mb-2">Meal 2: Solid Meal 1 (500 kcal)</h3>
                    <p class="text-sm text-gray-700 font-semibold">Focus: Post-Workout Carbs & Minimal Protein</p>
                    <ul class="list-disc list-inside text-sm text-gray-600 mt-2 space-y-1">
                        <li>1 Cup Rolled Oats (dry measure)</li>
                        <li>1 Tbsp Natural Peanut Butter</li>
                        <li>1 Medium Banana</li>
                        <li>Water/Black Coffee</li>
                    </ul>
                </div>
                
                

<div class="meal-card border-l-[#2196F3]">
                    <h3 class="text-lg font-bold text-[#2196F3] mb-2">Meal 3: High-Dose Whey Shake (320 kcal)</h3>
                    <p class="text-sm text-gray-700 font-semibold">Focus: 64g Pure Protein, Mid-day Top-up</p>
                    <ul class="list-disc list-inside text-sm text-gray-600 mt-2 space-y-1">
                        <li>2.6 Scoops Gold Standard Whey (64g Protein)</li>
                        <li>Mixed with Water</li>
                        <li>*(Crucial for hitting protein target)*</li>
                    </ul>
                </div>

                 

<div class="meal-card border-l-[#03A9F4]">
                    <h3 class="text-lg font-bold text-[#03A9F4] mb-2">Meal 4: Solid Meal 2 (500 kcal)</h3>
                    <p class="text-sm text-gray-700 font-semibold">Focus: Healthy Fats, Fiber & Micronutrients</p>
                    <ul class="list-disc list-inside text-sm text-gray-600 mt-2 space-y-1">
                        <li>1 Small Sweet Potato (approx. 100g)</li>
                        <li>Large Mixed Green Salad</li>
                        <li>1.5 Tbsp Olive Oil (for dressing)</li>
                        <li>1/4 Avocado</li>
                    </ul>
                </div>
                
                

<div class="meal-card border-l-[#8BC34A]">
                    <h3 class="text-lg font-bold text-[#8BC34A] mb-2">Meal 5: High-Dose Whey Shake (320 kcal)</h3>
                    <p class="text-sm text-gray-700 font-semibold">Focus: 64g Pure Protein, Before Bed Anti-Catabolic</p>
                    <ul class="list-disc list-inside text-sm text-gray-600 mt-2 space-y-1">
                        <li>2.6 Scoops Gold Standard Whey (64g Protein)</li>
                        <li>Mixed with Water</li>
                        <li>*(Use kitchen scale for accuracy)*</li>
                    </ul>
                </div>
            </div>
        </section>


        <section id="macro-composition" class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
            
            <div class="lg:col-span-1 card">
                <h2 class="text-2xl font-bold accent-text mb-4">Macro Composition Overview</h2>
                <p class="text-gray-700 mb-6">This plan is a **highly aggressive, protein-centric cut**. The <span id="macro-p-perc"></span>% protein ensures maximum muscle retention while the lower carbs and moderate fats drive significant fat loss.</p>
                <div class="chart-container h-[350px]">
                    <canvas id="macroDonutChart"></canvas>
                </div>
                <p class="text-sm text-gray-500 mt-4 text-center">Breakdown: P (<span id="macro-p-perc"></span>%) C (<span id="macro-c-perc"></span>%) F (<span id="macro-f-perc"></span>%)</p>
            </div>

            <div class="lg:col-span-2 card">
                <h2 class="text-2xl font-bold accent-text mb-4">Calorie Distribution Across 5 Meals</h2>
                <p class="text-gray-700 mb-6">Calories are distributed to deliver large protein doses around critical times (morning, post-workout, bedtime), with solid meals supplementing energy from carbs and healthy fats. (Target: <span id="line-chart-total"></span> kcal Total)</p>
                <div class="chart-container h-[400px] max-w-full">
                    <canvas id="calorieLineChart"></canvas>
                </div>
            </div>
            
        </section>
        
        <section id="detailed-analysis" class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">

            <div class="lg:col-span-1 card">
                <h2 class="text-2xl font-bold accent-text mb-4">Key Protein Source Breakdown</h2>
                <p class="text-gray-700 mb-6">**Whey protein accounts for the vast majority** of your daily protein intake, making precise measurement of each shake crucial. Remaining protein comes from whole food sources.</p>
                <div class="chart-container h-[300px]">
                    <canvas id="proteinBarChart"></canvas>
                </div>
            </div>

            <div class="lg:col-span-2 card">
                <h2 class="text-2xl font-bold accent-text mb-4">7-Day Classic Physique Training & Nutrient Blueprint</h2>
                <p class="text-gray-700 mb-6">This blueprint follows your requested **Push (Saturday), Pull (Sunday), Legs (Monday)** split. The 2000 kcal / 215g Protein plan is maintained daily, supporting muscle preservation even with intense training.</p>

                

<div class="day-grid">
                    

<div class="p-3 bg-red-100 border border-red-400 rounded-lg">
                        <div class="font-bold text-lg text-red-700">SAT</div>
                        <div class="text-sm font-semibold mt-1">PUSH</div>
                        <div class="text-xs text-gray-600">(Chest, Shoulders, Triceps)</div>
                    </div>
                    

<div class="p-3 bg-blue-100 border border-blue-400 rounded-lg">
                        <div class="font-bold text-lg text-blue-700">SUN</div>
                        <div class="text-sm font-semibold mt-1">PULL</div>
                        <div class="text-xs text-gray-600">(Back, Biceps, Traps)</div>
                    </div>
                    

<div class="p-3 bg-green-100 border border-green-400 rounded-lg">
                        <div class="font-bold text-lg text-green-700">MON</div>
                        <div class="text-sm font-semibold mt-1">LEGS</div>
                        <div class="text-xs text-gray-600">(Quads, Hams, Calves)</div>
                    </div>
                    

<div class="p-3 bg-yellow-100 border border-yellow-400 rounded-lg">
                        <div class="font-bold text-lg text-yellow-700">TUE</div>
                        <div class="text-sm font-semibold mt-1">Active Rest</div>
                        <div class="text-xs text-gray-600">(LISS Cardio/Mobility)</div>
                    </div>
                    

<div class="p-3 bg-red-100 border border-red-400 rounded-lg">
                        <div class="font-bold text-lg text-red-700">WED</div>
                        <div class="text-sm font-semibold mt-1">PUSH</div>
                        <div class="text-xs text-gray-600">(Chest, Shoulders, Triceps)</div>
                    </div>
                    

<div class="p-3 bg-blue-100 border border-blue-400 rounded-lg">
                        <div class="font-bold text-lg text-blue-700">THU</div>
                        <div class="text-sm font-semibold mt-1">PULL</div>
                        <div class="text-xs text-gray-600">(Back, Biceps, Traps)</div>
                    </div>
                    

<div class="p-3 bg-green-100 border border-green-400 rounded-lg">
                        <div class="font-bold text-lg text-green-700">FRI</div>
                        <div class="text-sm font-semibold mt-1">LEGS</div>
                        <div class="text-xs text-gray-600">(Quads, Hams, Calves)</div>
                    </div>
                </div>
                
                <div class="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <h3 class="font-bold text-gray-800">Timing Note:</h3>
                    <p class="text-sm text-gray-600">The 2000 kcal / 215g Protein plan is consistent daily. For optimal nutrient timing, try to place **Solid Meal 1 (Oats, PB, Banana)** around your main workout session to fuel performance or kickstart recovery.</p>
                </div>
            </div>
            
        </section>

        <section id="principles" class="mb-12">
            <h2 class="text-3xl font-bold accent-text mb-6 text-center">Non-Negotiable Principles of the Cut</h2>
            
            <audio id="audioPlayer" class="w-full mb-4" controls hidden></audio>
            
            <div id="principles-text-container" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                
                <div class="card p-6 bg-gray-50 border-t-4 border-t-[#00C853]">
                    <div class="flex items-center mb-3">
                        <span class="text-2xl font-black text-[#00C853] mr-3">&#9733;</span>
                        <h3 class="text-xl font-semibold">Hyper-Hydration</h3>
                    </div>
                    <p class="text-gray-700 text-sm">Target 1.5 - 2 Gallons of water daily. With high protein intake, this is **critical** for kidney function, nutrient transport, and minimizing water retention for a "dry" look.</p>
                </div>

                <div class="card p-6 bg-gray-50 border-t-4 border-t-[#00C853]">
                    <div class="flex items-center mb-3">
                        <span class="text-2xl font-black text-[#00C853] mr-3">&#9733;</span>
                        <h3 class="text-xl font-semibold">Micro-Nutrient Density</h3>
                    </div>
                    <p class="text-gray-700 text-sm">Although protein is dominant, prioritize nutrient-dense whole foods like green, fibrous vegetables. These provide essential vitamins, minerals, and satiety with minimal calories.</p>
                </div>

                <div class="card p-6 bg-gray-50 border-t-4 border-t-[#00C853]">
                    <div class="flex items-center mb-3">
                        <span class="text-2xl font-black text-[#00C853] mr-3">&#9733;</span>
                        <h3 class="text-xl font-semibold">Precision & Adherence</h3>
                    </div>
                    <p class="text-gray-700 text-sm">With such tight macros, **accurate measurement** of whey and solid foods is paramount. Consistency in following this plan will be the key to achieving your physique goals.</p>
                </div>
            </div>
            <button id="ttsButton" onclick="speakPrinciples()" class="w-full mt-6 bg-[#00C853] text-white py-2 rounded-md font-semibold hover:bg-green-600 button-shadow flex items-center justify-center">
                üîä Hear Principles Read
            </button>
        </section>

    </div>
</body>
</html>
